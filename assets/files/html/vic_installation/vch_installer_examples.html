<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Examples of Deploying a Virtual Container Host | VMware vSphere Integrated Containers Engine Installation, version 0.7.0</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./verify_vch_deployment.html" />
    
    
    <link rel="prev" href="./vch_installer_options.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="2.2"
        data-chapter-title="Examples of Deploying a Virtual Container Host"
        data-filepath="vch_installer_examples.md"
        data-basepath="."
        data-revision="Thu Nov 10 2016 17:03:44 GMT+0100 (W. Europe Standard Time)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="introduction.html">
            
                
                    <a href="./introduction.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Overview of vSphere Integrated Containers Engine for vSphere Administrators
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="contents_of_vic_binaries.html">
            
                
                    <a href="./contents_of_vic_binaries.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Contents of the vSphere Integrated Containers Engine Binaries
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="vic_installation_prereqs.html">
            
                
                    <a href="./vic_installation_prereqs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Environment Prerequisites for vSphere Integrated Containers Engine Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="networks.html">
            
                
                    <a href="./networks.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Networks Used by vSphere Integrated Containers Engine
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="install_vic_cli.html">
            
                
                    <a href="./install_vic_cli.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Deploy a Virtual Container Host
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="vch_installer_options.html">
            
                
                    <a href="./vch_installer_options.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Virtual Container Host Deployment Options
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.2" data-path="vch_installer_examples.html">
            
                
                    <a href="./vch_installer_examples.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Examples of Deploying a Virtual Container Host
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="verify_vch_deployment.html">
            
                
                    <a href="./verify_vch_deployment.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Verify the Deployment of a Virtual Container Host
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="install_vic_plugin.html">
            
                
                    <a href="./install_vic_plugin.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Installing the vSphere Web Client Plug-in for vSphere Integrated Containers Engine
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="plugin_vc_web.html">
            
                
                    <a href="./plugin_vc_web.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Install the vSphere Integrated Containers Engine Plug-In on vCenter Server For Windows by Using a Web Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="plugin_vc_no_web.html">
            
                
                    <a href="./plugin_vc_no_web.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Install the vSphere Integrated Containers Engine Plug-In on vCenter Server for Windows Without Access to a Web Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="plugin_vcsa_web.html">
            
                
                    <a href="./plugin_vcsa_web.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Install the vSphere Integrated Containers Engine Plug-In on a vCenter Server Appliance by Using a Web Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="plugin_vcsa_no_web.html">
            
                
                    <a href="./plugin_vcsa_no_web.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Install the vSphere Integrated Containers Engine Plug-In on a vCenter Server Appliance Without Access to a Web Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="plugin_verify_deployment.html">
            
                
                    <a href="./plugin_verify_deployment.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Verify the Deployment of the vSphere Integrated Containers Engine Plug-In
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="troubleshoot_vic_install.html">
            
                
                    <a href="./troubleshoot_vic_install.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Troubleshooting vSphere Integrated Containers Engine Installation
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="ts_resource_pool_error.html">
            
                
                    <a href="./ts_resource_pool_error.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        VCH Deployment Fails with Resource Pool Creation Error
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="ts_cli_argument_error.html">
            
                
                    <a href="./ts_cli_argument_error.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        VCH Deployment Fails with Unknown or Non-Specified Argument Error or Incorrect User Name Error
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="ts_firewall_error.html">
            
                
                    <a href="./ts_firewall_error.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        VCH Deployment Fails with Firewall Validation Error
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="ts_ui_not_appearing.html">
            
                
                    <a href="./ts_ui_not_appearing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        vSphere Integrated Containers Engine Plug-In Does Not Appear in the vSphere Web Client
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="ts_docker_version_error.html">
            
                
                    <a href="./ts_docker_version_error.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        Docker Commands Fail with a Docker API Version Error
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >VMware vSphere Integrated Containers Engine Installation, version 0.7.0</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="examples-of-deploying-a-virtual-container-host">Examples of Deploying a Virtual Container Host</h1>
<p>This topic provides examples of the options of the <code>vic-machine create</code> command to use when deploying virtual container hosts in different vSphere configurations.</p>
<ul>
<li><a href="#esxi">Deploy to an ESXi Host with no Resource Pools and a Single Datastore</a></li>
<li><a href="#cluster">Deploy to a vCenter Server Cluster</a></li>
<li><a href="#networks">Specify External, Management, Client, and Container Networks</a></li>
<li><a href="#ip-range">Configure a Non-DHCP Container Network</a></li>
<li><a href="#static-ip">Set a Static IP Address on the Different Networks</a></li>
<li><a href="#volume-stores">Specify One or More Volume Stores</a></li>
<li><a href="#standalone">Deploy to a Standalone Host in vCenter Server</a></li>
<li><a href="#rp_host">Deploy to a Resource Pool on an ESXi Host</a></li>
<li><a href="#rp_cluster">Deploy to a Resource Pool in a vCenter Server Cluster</a></li>
<li><a href="#auto_cert">Use Auto-Generated Trusted CA Certificates</a></li>
<li><a href="#custom_cert">Use Custom Trusted CA Certificates</a></li>
<li><a href="#customized">Limit Resource Use</a></li>
<li><a href="#registry">Authorize Access to an Insecure Private Registry Server</a></li>
<li><a href="#proxy">Configure a Proxy Server</a></li>
</ul>
<p>For simplicity, unless stated otherwise, these examples assume that the vSphere environment uses trusted certificates signed by a known Certificate Authority (CA), so the <code>--thumbprint</code> option is not specified. Similarly, all examples that do not relate explicitly to certificate use specify the <code>--tls-noverify</code> option.</p>
<p>For detailed descriptions of all of the <code>vic-machine create</code> options, see <a href="vch_installer_options.html">Virtual Container Host Deployment Options</a>.</p>
<p><a name="esxi"></a></p>
<h2 id="deploy-to-an-esxi-host-with-no-resource-pools-and-a-single-datastore">Deploy to an ESXi Host with no Resource Pools and a Single Datastore</h2>
<p>You can deploy a virtual container host directly on an ESXi host that is not managed by a vCenter Server instance. This example provides the minimum options required to deploy a virtual container host, namely the <code>--target</code> and <code>--user</code> options and an authentication option. The <code>vic-machine create</code> command prompts you for the password for the ESXi host and deploys a virtual container host with the default name <code>virtual-container-host</code>. If there is only one datastore on the host and there are no resource pools, you do not need to specify the <code>--image-store</code> or <code>--compute-resource</code> options. When deploying to an ESXi host, <code>vic-machine create</code> creates a standard virtual switch and a distributed port group, so you do not need to specify any network options if you do not have specific network requirements. The example uses the <code>--no-tlsverify</code> option to implement TLS authentication with self-signed untrusted certificates, with no client verification.</p>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target <i>esxi_host_address</i>
--user root
--no-tlsverify
</pre>

<p><a name="cluster"></a></p>
<h2 id="deploy-to-a-vcenter-server-cluster">Deploy to a vCenter Server Cluster</h2>
<p>If vCenter Server has more than one datacenter, you specify the datacenter in the <code>--target</code> option.</p>
<p>If vCenter Server manages more than one cluster, you use the <code>--compute-resource</code> option to specify the cluster on which to deploy the virtual container host.</p>
<p>When deploying a virtual container host to vCenter Server, you must use the <code>--bridge-network</code> option to specify an existing distributed port group for container VMs to use to communicate with each other. For information about how to create a distributed virtual switch and port group, see <em>Network Requirements</em> in <a href="vic_installation_prereqs.html#networkreqs">Environment Prerequisites for vSphere Integrated Containers Engine Installation</a>.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Provides the vCenter Single Sign-On user and password in the <code>--target</code> option. Note that the user name is wrapped in quotes, because it contains the <code>@</code> character. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system. </li>
<li>Deploys a virtual container host named <code>vch1</code> to the cluster <code>cluster1</code> in datacenter <code>dc1</code>. </li>
<li>Uses a distributed port group named <code>vic-bridge</code> for the bridge network. </li>
<li>Designates <code>datastore1</code> as the datastore in which to store container images, the files for the virtual container host appliance, and container VMs. </li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--name vch1
--no-tlsverify
</pre>

<p><a name="networks"></a></p>
<h2 id="specify-external-management-client-and-container-networks">Specify External, Management, Client, and Container Networks</h2>
<p>In addition to the mandatory bridge network, if your vCenter Server environment includes multiple networks, you can direct different types of traffic to different networks. </p>
<ul>
<li>You can direct the traffic between the virtual container host, container VMs, and the internet to a specific network by specifying the <code>external-network</code> option. If you do not specify the <code>external-network</code> option, the virtual container host uses the default VM Network for external traffic.</li>
<li>You can direct traffic between ESXi hosts, vCenter Server, and the virtual container host to a specific network by specifying the <code>--management-network</code> option. If you do not specify the <code>--management-network</code> option, the virtual container host uses the external network for management traffic.</li>
<li>You can designate a specific network for use by the Docker API by specifying the <code>--client-network</code> option. If you do not specify the <code>--client-network</code> option, the Docker API uses the external network.</li>
<li>You can designate a specific network for container VMs to use by specifying the <code>--container-network</code> option. Containers use this network if the container developer runs <code>docker run</code> or <code>docker create</code> with the <code>--net</code> option when they run or create a container. This option requires a distributed port group that must exist before you run <code>vic-machine create</code>. You cannot use the same distributed port group that you use for the bridge network. You can provide a descriptive name for the network, for use by Docker. If you do not specify a descriptive name, Docker uses the vSphere network name. For example, the descriptive name appears as an available network in the output of <code>docker info</code>. </li>
</ul>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, image store, bridge network, and name for the virtual container host.</li>
<li>Directs external, management, and Docker API traffic to network 1, network 2, and network 3 respectively. Note that the network names are wrapped in quotes, because they contain spaces. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system.</li>
<li>Designates a distributed port group named <code>vic-containers</code> for use by container VMs that are run with the <code>--net</code> option.</li>
<li>Gives the container network the name <code>vic-container-network</code>, for use by Docker.  </li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--external-network &apos;network 1&apos;
--management-network &apos;network 2&apos;
--client-network &apos;network 3&apos;
--container-network vic-containers:vic-container-network
--name vch1
--no-tlsverify
</pre>

<p>For more information about the networking options, see the <a href="vch_installer_options.html#networking">Networking Options section</a> in Virtual Container Host Deployment Options.</p>
<p><a name="ip-range"></a></p>
<h2 id="configure-a-nondhcp-container-network">Configure a Non-DHCP Container Network</h2>
<p>If the network that you designate as the container network in the <code>--container-network</code> option does not support DHCP, you can configure the gateway, DNS server, and a range of IP addresses for container VMs to use. </p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, image store, bridge network, and name for the virtual container host.</li>
<li>Uses the default VM Network for the external, management, and client networks.</li>
<li>Designates a distributed port group named <code>vic-containers</code> for use by container VMs that are run with the <code>--net</code> option.</li>
<li>Gives the container network the name <code>vic-container-network</code>, for use by Docker. </li>
<li>Specifies the gateway, two DNS servers, and a range of IP addresses on the container network for container VMs to use.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--container-network vic-containers:vic-container-network
--container-network-gateway vic-containers:<i>gateway_ip_address</i>/255.255.255.0
--container-network-dns vic-containers:<i>dns1_ip_address</i>
--container-network-dns vic-containers:<i>dns2_ip_address</i>
--container-network-ip-range vic-containers:192.168.100.0/24
--name vch1
--no-tlsverify
</pre>

<p>For more information about the container network options, see the <a href="vch_installer_options.html#container-network">container network section</a> in Virtual Container Host Deployment Options.</p>
<p><a name="static-ip"></a></p>
<h2 id="set-a-static-ip-address-on-the-different-networks">Set a Static IP Address on the Different Networks</h2>
<p>If you specify networks for any or all of the external, management, and client networks, you can deploy the virtual container host so that the virtual container host endpoint VM has a static IP address on those networks. </p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, image store, bridge network, and name for the virtual container host.</li>
<li>Directs external, management, and Docker API traffic to network 1, network 2, and network 3 respectively. Note that the network names are wrapped in quotes, because they contain spaces. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system.</li>
<li>Sets a DNS server for use by the virtual container host.</li>
<li>Sets a static IP address for the virtual container host endpoint VM on each of the external, management, and client networks. </li>
</ul>
<p><strong>NOTE</strong>: When you specify a static IP address for the virtual container host on the client network, <code>vic-machine create</code> uses this address as the Common Name with which to create auto-generated trusted certificates. In this case, full TLS authentication is implemented by default and you do not need to specify any authentication options. </p>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--external-network &apos;network 1&apos;
--external-network-gateway 192.168.1.1/24
--external-network-ip 192.168.1.10/24
--management-network &apos;network 2&apos;
--management-network-gateway 192.168.2.1/24
--management-network-ip 192.168.2.10/24
--client-network &apos;network 3&apos;
--client-network-gateway 192.168.3.1/24
--client-network-ip 192.168.3.10/24
--dns-server <i>dns_server_address</i>
--name vch1
</pre>

<p>For more information about the networking options, see the <a href="vch_installer_options.html#static-ip">Options for Specifying a Static IP Address for the Virtual Container Host Endpoint VM</a> in Virtual Container Host Deployment Options.</p>
<p><a name="volume-stores"></a></p>
<h2 id="specify-one-or-more-volume-stores">Specify One or More Volume Stores</h2>
<p>If container application developers will use the <code>docker volume create</code> command to create containers that use volumes, you must create volume stores when you deploy virtual container hosts. You specify volume stores in the <code>--volume-store</code> option. You can specify <code>--volume-store</code> multiple times to create multiple volume stores. </p>
<p>When you create a volume store, you specify the name of the datastore to use and an optional path to a folder on that datastore. You also specify a descriptive name for that volume store for use by Docker.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, bridge network, and name for the virtual container host.</li>
<li>Specifies the <code>volumes</code> folder on <code>datastore 1</code> as the default volume store. Creating a volume store named <code>default</code> allows container application developers to create anonymous or named volumes by using <code>docker create -v</code>. </li>
<li>Specifies a second volume store named <code>volume_store_2</code> in the <code>volumes</code> folder on <code>datastore 2</code>. </li>
<li>Note that the datastore names are wrapped in quotes, because they contain spaces. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--bridge-network vic-bridge
--image-store &apos;datastore 1&apos;
--volume-store &apos;datastore 1&apos;/volumes:default
--volume-store &apos;datastore 2&apos;/volumes:volume_store_2
--name vch1
--no-tlsverify
</pre>

<p>For more information about volume stores, see the <a href="vch_installer_options.html#volume-store">volume-store section</a> in Virtual Container Host Deployment Options. </p>
<p><a name="standalone"></a> </p>
<h2 id="deploy-to-a-standalone-host-in-vcenter-server">Deploy to a Standalone Host in vCenter Server</h2>
<p>If vCenter Server manages multiple standalone ESXi hosts that are not part of a cluster, you use the <code>--compute-resource</code> option to specify the address of the ESXi host to which to deploy the virtual container host.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, bridge network, and name for the virtual container host.</li>
<li>Deploys the virtual container host on the ESXi host with the FQDN <code>esxihost1.organization.company.com</code> in the datacenter <code>dc1</code>. You can also specify an IP address.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--image-store datastore1
--bridge-network vic-bridge
--compute-resource esxihost1.organization.company.com
--name vch1
--no-tlsverify
</pre>

<p><a name="rp_host"></a></p>
<h2 id="deploy-to-a-resource-pool-on-an-esxi-host">Deploy to a Resource Pool on an ESXi Host</h2>
<p>To deploy a virtual container host in a specific resource pool on an ESXi host that is not managed by vCenter Server, you specify the resource pool name in the <code>--compute-resource</code> option. </p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name and password, and a name for the virtual container host.</li>
<li>Designates <code>rp 1</code> as the resource pool in which to place the virtual container host. Note that the resource pool name is wrapped in quotes, because it contains a space. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target root:<i>password</i>@<i>esxi_host_address</i>
--compute-resource &apos;rp 1&apos;
--name vch1
--no-tlsverify
</pre>

<p><a name="rp_cluster"></a></p>
<h2 id="deploy-to-a-resource-pool-in-a-vcenter-server-cluster">Deploy to a Resource Pool in a vCenter Server Cluster</h2>
<p>To deploy a virtual container host in a resource pool in a vCenter Server cluster, you specify the names of the cluster and resource pool in the <code>compute-resource</code> option.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, image store, bridge network, and name for the virtual container host.</li>
<li>Designates <code>rp 1</code> in cluster <code>cluster 1</code> as the resource pool in which to place the virtual container host. Note that the resource pool and cluster names are wrapped in quotes, because they contain spaces. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource &apos;cluster 1&apos;/&apos;rp 1&apos;
--image-store datastore1
--bridge-network vic-bridge
--name vch1
--no-tlsverify
</pre>

<p><a name="auto_cert"></a></p>
<h2 id="use-autogenerated-trusted-ca-certificates">Use Auto-Generated Trusted CA Certificates</h2>
<p>You can deploy a virtual container host that implements two-way authentication with trusted auto-generated TLS certificates that are signed by a Certificate Authority (CA). To automatically generate a trusted CA certificate, you provide information that <code>vic-machine create</code> uses to populate the fields of a certificate request. At a minimum, you must specify the FQDN or the name of the domain in which the virtual container host will run in the <code>--tls-cname</code> option. <code>vic-machine create</code> uses the name as the Common Name in the certificate request. You can also optionally specify a CA file, an organization name, and a size for the certificate key. </p>
<p><strong>NOTE</strong>: Because the <code>--tls-cname</code> option requires an FQDN or domain name, you must have a DNS service running on the client network on which you deploy the virtual container host. However, if you specify a static IP address for the virtual container host endpoint VM on the client network, <code>vic-machine create</code> uses this address as the Common Name with which to create an auto-generated trusted certificate. In this case, full TLS authentication is implemented by default and you do not need to specify any authentication options, and DNS is not required on the client network.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the virtual container host.</li>
<li>Provides <code>vch1.example.org</code> as the FQDN for the virtual container host, for use as the Common Name in the certificate.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--tls-cname vch1.example.org
--name vch1
</pre>

<p>For more information about using auto-generated CA certificates, see the <a href="vch_installer_options.html#security">Security Options section</a> in Virtual Container Host Deployment Options.</p>
<p><a name="custom_cert"></a></p>
<h2 id="use-custom-trusted-ca-certificates">Use Custom Trusted CA Certificates</h2>
<p>If your development environment uses custom CA certificates to authenticate connections between Docker clients and virtual container hosts, use the <code>--cert</code> and <code>--key</code> options to provide the paths to a custom X.509 certificate and its key when you deploy a virtual container host. The paths to the certificate and key files must be relative to the location from which you are running <code>vic-machine create</code>.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the virtual container host.</li>
<li>Provides the paths relative to the current location of the <code>*.pem</code> files for the custom CA certificate and key files.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--cert ../some/relative/path/<i>certificate_file</i>.pem
--key ../some/relative/path/<i>key_file</i>.pem
--name vch1
</pre>

<p>For more information about using custom CA certificates, see the <a href="vch_installer_options.html#adv-security">Advanced Security Options section</a> in Virtual Container Host Deployment Options.</p>
<p><a name="customized"></a></p>
<h2 id="limit-resource-use">Limit Resource Use</h2>
<p>To limit the amount of system resources that the container VMs in a virtual container host can use, you can set resource limits on the virtual container host vApp. </p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the virtual container host.</li>
<li>Sets resource limits on the virtual container host by imposing memory and CPU reservations, limits, and shares.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--memory 1024
--memory-reservation 1024
--memory-shares low
--cpu 1024
--cpu-reservation 1024
--cpu-shares low
--name vch1
--no-tlsverify
</pre>

<p>For more information about setting resource use limitations on virtual container hosts, see the <a href="vch_installer_options.html#deployment">vApp Deployment Options</a> and <a href="vch_installer_options.html#adv-mgmt">Advanced Resource Management Options</a> sections in Virtual Container Host Deployment Options.</p>
<p><a name="registry"></a></p>
<h2 id="authorize-access-to-an-insecure-private-registry-server">Authorize Access to an Insecure Private Registry Server</h2>
<p>An insecure private registry server is a private registry server for Docker images that is secured by self-signed certificates rather than by TLS. To authorize connections from a virtual container host to an insecure private registry server, set the <code>insecure-registry</code> option. You can specify <code>insecure-registry</code> multiple times to allow connections from the virtual container host to multiple insecure private registry servers.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the virtual container host.</li>
<li>Authorizes the virtual container host to pull Docker images from the insecure private registry servers located at the URLs <i>registry_URL_1</i> and <i>registry_URL_2</i>.</li>
<li>The registry server at <i>registry_URL_2</i> listens for connections on port 5000. </li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--insecure-registry <i>registry_URL_1</i>
--insecure-registry <i>registry_URL_2:5000</i>
--name vch1
--no-tlsverify
</pre>

<p>For more information about configuring virtual container hosts to connect to insecure private registry servers, see the section on the <a href="vch_installer_options.html#registry"><code>insecure-registry</code> option</a> in Virtual Container Host Deployment Options.</p>
<p><strong>NOTE</strong>: The current builds of vSphere Integrated Containers do not yet support private registry servers that you secure by using TLS certificates.</p>
<p><a name="proxy"></a></p>
<h2 id="configure-a-proxy-server">Configure a Proxy Server</h2>
<p>If your network access is controlled by a proxy server, you must   configure a virtual container host to connect to the proxy server when you deploy it, so that it can pull images from external sources.</p>
<p>This example deploys a virtual container host with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the virtual container host.</li>
<li>Configures the virtual container host to access the network via an HTTPS proxy server.</li>
</ul>
<pre>vic-machine<i>-darwin</i><i>-linux</i><i>-windows</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vic-bridge
--https-proxy https://<i>proxy_server_address</i>:<i>port</i>
--name vch1
--no-tlsverify
</pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./vch_installer_options.html" class="navigation navigation-prev " aria-label="Previous page: Virtual Container Host Deployment Options"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./verify_vch_deployment.html" class="navigation navigation-next " aria-label="Next page: Verify the Deployment of a Virtual Container Host"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
